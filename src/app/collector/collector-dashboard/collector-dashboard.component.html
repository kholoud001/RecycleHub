<div class="min-h-screen bg-gray-100">

  <!-- Navbar -->
  <nav class="bg-blue-600 p-4 shadow-md">
    <div class="container mx-auto flex justify-between items-center">
      <a href="#" class="text-white font-bold text-xl">Dashboard</a>
      <ul class="flex space-x-6">
        <li><button (click)="setPage('myRequests')" class="text-white hover:text-gray-300">Mes demandes</button></li>
        <li><button (click)="setPage('profile')" class="text-white hover:text-gray-300">Profil</button></li>
        <li><button (click)="setPage('points')" class="text-white hover:text-gray-300">Système de points</button></li>
        <li><button (click)="setPage('convert')" class="text-white hover:text-gray-300">Conversion</button></li>
        <li><button class="text-white hover:text-gray-300">Se déconnecter</button></li>
      </ul>
    </div>
  </nav>

  <!-- Content -->
  <div class="container mx-auto mt-6">
    <div class="bg-white p-6 rounded-lg shadow-md">
      <h2 class="text-2xl font-bold mb-4">Bienvenue, {{ connectedUser?.nom }}!</h2>

      <!-- Mes Demandes -->
      <div *ngIf="currentPage === 'myRequests'">
        <h3 class="text-xl font-semibold mb-4">📋 Mes demandes</h3>
        <p class="text-gray-700">Gérez vos collectes ici.</p>
      </div>




          <!-- 📝 Profil -->
          <div *ngIf="currentPage === 'profile'">
            <h3 class="text-xl font-semibold mb-4">👤 Profil</h3>

            <!-- Profile Image -->
            <div class="flex items-center space-x-4">
              <img *ngIf="connectedUser.photo"
                   [src]="connectedUser.photo"
                   alt="Photo de profil"
                   class="w-24 h-24 rounded-full border border-gray-300 shadow-md object-cover">

            </div>

            <!-- Mode édition -->
            <div *ngIf="isEditing; else profileView">
              <label class="block">Nom :</label>
              <input type="text" [(ngModel)]="updatedUser.nom" class="border p-2 w-full rounded-md mb-2">

              <label class="block">Prénom :</label>
              <input type="text" [(ngModel)]="updatedUser.prenom" class="border p-2 w-full rounded-md mb-2">

              <label class="block">Email :</label>
              <input type="email" [(ngModel)]="updatedUser.email" class="border p-2 w-full rounded-md mb-2">

              <label class="block">Téléphone :</label>
              <input type="text" [(ngModel)]="updatedUser.telephone" class="border p-2 w-full rounded-md mb-2">

              <button (click)="saveProfile()" class="bg-green-500 text-white px-4 py-2 rounded-md mr-2">✅ Sauvegarder</button>
              <button (click)="cancelEdit()" class="bg-gray-400 text-white px-4 py-2 rounded-md">❌ Annuler</button>
            </div>

            <!-- Affichage du profil -->
            <ng-template #profileView>
              <p><strong>Nom :</strong> {{ connectedUser.nom }}</p>
              <p><strong>Prénom :</strong> {{ connectedUser.prenom }}</p>
              <p><strong>Email :</strong> {{ connectedUser.email }}</p>
              <p><strong>Téléphone :</strong> {{ connectedUser.telephone }}</p>

              <button (click)="editProfile()" class="mt-4 bg-blue-600 text-white px-4 py-2 rounded-md mr-4">✏️ Modifier</button>
              <button (click)="deleteAccount()" class="mt-4 bg-red-600 text-white px-4 py-2 rounded-md">🗑️ Supprimer</button>

            </ng-template>
          </div>





      <!-- Système de Points -->
      <div *ngIf="currentPage === 'points'">
        <h3 class="text-xl font-semibold mb-4">🏆 Attribution des Points</h3>
        <p class="text-gray-700">Attribuez des points en fonction de la collecte.</p>

        <div class="grid grid-cols-2 gap-4 mt-4">
          <label>Plastique (kg) : <input type="number" [(ngModel)]="collectedMaterials.plastique" class="border p-1 w-20"></label>
          <label>Verre (kg) : <input type="number" [(ngModel)]="collectedMaterials.verre" class="border p-1 w-20"></label>
          <label>Papier (kg) : <input type="number" [(ngModel)]="collectedMaterials.papier" class="border p-1 w-20"></label>
          <label>Métal (kg) : <input type="number" [(ngModel)]="collectedMaterials.metal" class="border p-1 w-20"></label>
        </div>

        <button (click)="validateCollection()" class="mt-4 bg-green-600 text-white px-4 py-2 rounded-md">✅ Valider la collecte</button>

        <h4 class="text-lg font-semibold mt-6">💰 Points du particulier : <span class="text-blue-600">{{ points }}</span></h4>
      </div>

      <!-- Conversion des Points -->
      <div *ngIf="currentPage === 'convert'">
        <h3 class="text-xl font-semibold mb-4">🎟️ Conversion des Points</h3>
        <p class="text-gray-700">Convertissez les points en bons d'achat.</p>

        <div class="grid grid-cols-3 gap-4 mt-4">
          <button *ngFor="let voucher of vouchers"
                  (click)="convertPoints(voucher.points)"
                  class="bg-yellow-500 text-white px-4 py-2 rounded-md">
            {{ voucher.points }} points → {{ voucher.value }} Dh
          </button>
        </div>

        <h4 class="text-lg font-semibold mt-6">💰 Points restants : <span class="text-blue-600">{{ points }}</span></h4>
      </div>

    </div>
  </div>
</div>
